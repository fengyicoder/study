# 音视频技术概述

帧率：FPS，每秒多少帧画面；以及Gop，表示多少秒一个I帧；

码流：编码器每秒编出的数据大小，单位是kbps；

分辨率：单位英寸中包含的像素点数，VGA：Video Graphics Array（视频图像分辨率）

音视频的未来展望：

1. 追求播放体验的超高清、高码率和高帧率；
2. 低延迟流媒体传输；
3. 新型媒体显示设备形态；



# 图像、像素与颜色空间

图像是一种在二维平面上通过排列像素来表达信息的数据组织形式，像素一般表示图像某个位置的亮度或色彩信息。



对于灰度图像，每个像素点上只有一个分量，即该点的亮度值。图像位深常见为8bit或10bit；

彩色图像则是每个像素点上包含多个分量，常见为RGB通道。



### 图像的颜色空间

颜色空间：彩色数据的表达方式，是一种利用整数区间来表达不同颜色的模型；

常见有以下颜色区间：

1. RGB颜色空间：由红绿蓝三基色构成的三维线性颜色空间；
2. YUV颜色空间：包括一个亮度分量Y跟两个色度分量，常见有YUV、NTSC以及Y'CrCb；



### 图像压缩编码

为了适应带宽需要对图像进行先压缩后传输，有以下两大类压缩方法：

- 无损压缩：压缩率较低，压缩后体积较大，没有信息损失，可通过压缩信息完全恢复原始信息；
- 有损压缩：压缩率较高，压缩后体积较小，有信息损失，无法完全还原原始信息；

无损压缩格式有TIFF、BMP、GIF和PNG等，主要使用基于预测或熵编码的算法；有损压缩格式有JPEG等，主要使用基于变换和量化编码的算法；



无损压缩编码中有以下两种编码方式：

- 游程编码：

  思路是使用数字+字符的方式来表示重复连续的数据，一般用于信息比较单一的数据，示例如下：

  AAAAABBCCCCCCDDAEE，可表示为5A2B6C1A2E；


- 哈夫曼编码：

  基于有序频率二叉树的编码方法，是可变长编码方式的一种，完全依赖码字出现的频率，是一种构造整体平均长度最短的编码方法，其关键步骤是构造复合哈夫曼编码规则的二叉树。哈夫曼树是一种特殊的二叉树，其叶子节点的个数与待编码的码元个数相同，每个叶子节点上都带有各自的权值。每个叶子节点的路径长度乘以该节点的权值总和即为整个二叉树的加权路径长度。在满足条件的各种二叉树中，路径长度最短的二叉树即为哈夫曼树，生成过程如图所示：

  ![哈夫曼树](C:\Users\user\Desktop\哈夫曼树.jpg)

  当访问左子树时，赋予码字0，访问右子树时赋予码字1。例如图示的哈夫曼树，其编码码表为：

  A:0000

  B:0001

  C:01

  D:1



常见的图像压缩编码格式：

1. BMP格式：可保存位深为1bit、4bit、8bit、16bit、24bit或32bit的图像；

2. JPEG格式：基于离散余弦变换的有损压缩编码格式，离散余弦变换具有以下的特点：变换后的频域能量分布与实际的图像信号更加吻合；更容易兼容硬件计算，运算更高效。变换公式如下：

   ${X_n} = \sum\limits_{k = 0}^{N - 1} {{C_k}{y_k}\cos \frac{{(2n + 1)k\pi }}{{2N}}} $

   其压缩步骤大致如下：将图像数据变换为YUV格式，并对两个亮度分量进行亚像素采样，生成4：2：0的图像数据；针对每个分量进行处理，裁成8*8大小的像素块，并使用离散余弦变换变换至值频域并进行量化；其直流分量经过DPCM编码，交流分量通过之字形扫描转换成一维数据再通过游程编码进行处理；处理后的数据采用熵编码生成压缩码流流出。



# 视频压缩编码

在视频压缩编码中，图像的颜色空间通常使用YCrCb颜色空间。

YUV像素格式与采样格式：Y代表亮度，UV分量代表色度，亮度与色度分量既可以一一对应，也可以对色度分量进行采样，常见的亚像素采样格式有4:4:4、4:2:2、4:2:0(4:1:1)。可如此采样的原因是人眼对亮度敏感，对色度不敏感。

常用的视频格式与分辨率：

原始图像数据需要转换为某种中间格式后才能进行编码和传输等后续操作，其中常用的格式如下：QCIF、CIF、4CIF/SD、HD/720P、FHD/1080P、UHD。



### 视频压缩编码基本原理

视频之所以可以压缩，主要在于其存在大量冗余信息：

- 时间冗余：视频相邻帧内容相似，存在运动关系；
- 空间冗余：视频某一帧内部相邻像素存在相似性；
- 编码冗余：视频中不同数据出现的概率不同；
- 视觉冗余：人的视觉系统对视频的不同内容敏感度不同

